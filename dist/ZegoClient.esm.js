import{jsx as e,jsxs as t,Fragment as n}from"react/jsx-runtime";import o from"react-dom/client";import{ZegoExpressEngine as r}from"zego-express-engine-webrtc";import i from"react";import{IntlProvider as a}from"react-intl";function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
u=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,o){var r=Object.create((t&&t.prototype instanceof p?t:p).prototype),i=new O(o||[]);return r._invoke=function(e,t,n){var o="suspendedStart";return function(r,i){if("executing"===o)throw Error("Generator is already running");if("completed"===o){if("throw"===r)throw i;return C()}for(n.method=r,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var c=l(e,t,n);if("normal"===c.type){if(o=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o="completed",n.method="throw",n.arg=c.arg)}}}(e,n,i),r}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function p(){}function m(){}function h(){}var f={};s(f,r,(function(){return this}));var _=Object.getPrototypeOf,v=_&&_(_(w([])));v&&v!==t&&n.call(v,r)&&(f=v);var g=h.prototype=p.prototype=Object.create(f);function x(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function o(r,i,a,s){var c=l(e[r],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,a,s)}),(function(e){o("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return o("throw",e,a,s)}))}s(c.arg)}var r;this._invoke=function(e,n){function i(){return new t((function(t,r){o(e,n,t,r)}))}return r=r?r.then(i,i):i()}}function S(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var o=l(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var r=o.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function w(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:C}}function C(){return{value:void 0,done:!0}}return m.prototype=h,s(g,"constructor",h),s(h,"constructor",m),m.displayName=s(h,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,a,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},x(y.prototype),s(y.prototype,i,(function(){return this})),e.AsyncIterator=y,e.async=function(t,n,o,r,i){void 0===i&&(i=Promise);var a=new y(c(t,n,o,r),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(g),s(g,a,"Generator"),s(g,r,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var o=t.pop();if(o in e)return n.value=o,n.done=!1,n}return n.done=!0,n}},e.values=w,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return a.type="throw",a.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return o("end");if(this.prev>=i.tryLoc){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(i.catchLoc>this.prev)return o(i.catchLoc,!0);if(i.finallyLoc>this.prev)return o(i.finallyLoc)}else if(s){if(i.catchLoc>this.prev)return o(i.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(i.finallyLoc>this.prev)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o];if(this.prev>=r.tryLoc&&n.call(r,"finallyLoc")&&r.finallyLoc>this.prev){var i=r;break}}i&&("break"===e||"continue"===e)&&t>=i.tryLoc&&i.finallyLoc>=t&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var r=o.arg;k(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:w(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function l(e,t,n,o,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){l(i,o,r,a,s,"next",e)}function s(e){l(i,o,r,a,s,"throw",e)}a(void 0)}))}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;t.length>n;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function x(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=v(e);if(t){var r=v(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return x(this,n)}}function S(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);t>n;n++)o[n]=e[n];return o}var k=function(){function e(){p(this,e),this.instant=0,this.slow=0,this.clip=0,this.context=void 0,this.states={},this.context=new AudioContext}return h(e,[{key:"connectToSource",value:function(e,t){console.log("SoundMeter connecting");try{var n=this.context.createScriptProcessor(4096,1,1),o=0,r=0,i=0;n.onaudioprocess=function(e){var t,n=e.inputBuffer.getChannelData(0),a=0,s=0;for(t=0;n.length>t;++t)a+=n[t]*n[t],Math.abs(n[t])>.99&&(s+=1);r=.95*r+.05*(o=Math.sqrt(a/n.length)),i=s/n.length};var a=this.context.createMediaElementSource(e);a.connect(n),n.connect(this.context.destination),void 0!==t&&t({instant:o,slow:r,clip:i}),this.states[e.getAttribute("id")]={script:n,mic:a}}catch(e){console.error(e),void 0!==t&&t(e)}}},{key:"stop",value:function(e){console.log("SoundMeter stopping"),this.states[e.getAttribute("id")].mic&&this.states[e.getAttribute("id")].mic.disconnect(),this.states[e.getAttribute("id")].script&&this.states[e.getAttribute("id")].script.disconnect()}}]),e}(),O=function(){function e(){p(this,e),this._expressConfig=void 0,this.status={loginRsp:!1},this.remoteStreamMap={},this._config={container:void 0,joinScreen:{visible:!0,title:"EnterRoom",inviteURL:window.location.href},micEnabled:!0,cameraEnabled:!0,userCanToggleSelfCamera:!0,userCanToggleSelfMic:!0,chatEnabled:!0,userListEnabled:!0,notification:{userOnlineOfflineTips:!1,unreadMessageTips:!1},leaveRoomCallback:function(){},roomTimerDisplayed:!1,branding:{logoURL:""},leftScreen:!0,i18nURL:"",i18nJSON:""},this.onRemoteMediaUpdateCallBack=void 0,this.onRemoteUserUpdateCallBack=void 0,this.onRoomMessageUpdateCallBack=void 0,this.onNetworkStatusCallBack=void 0}var t,n,o,i,a,s,l;return h(e,[{key:"checkWebRTC",value:(l=d(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._zg.checkSystemRequirements("webRTC");case 2:return t.abrupt("return",!!t.sent.result);case 4:case"end":return t.stop()}}),t)}))),function(){return l.apply(this,arguments)})},{key:"setConfig",value:function(e){this._config=c(c({},this._config),e)}},{key:"getCameras",value:function(){return e._zg.getCameras()}},{key:"getMicrophones",value:function(){return e._zg.getMicrophones()}},{key:"getSpeakers",value:function(){return e._zg.getSpeakers()}},{key:"capturedSoundLevelUpdate",value:function(t,n){e._soundMeter.connectToSource(t,n)}},{key:"stopCapturedSoundLevelUpdate",value:function(t,n){e._soundMeter.stop(t)}},{key:"setVolume",value:function(e,t){e.volume=t}},{key:"createStream",value:(s=d(u().mark((function t(n){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._zg.createStream(n));case 1:case"end":return t.stop()}}),t)}))),function(e){return s.apply(this,arguments)})},{key:"setVideoConfig",value:(a=d(u().mark((function t(n,o){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._zg.setVideoConfig(n,o));case 1:case"end":return t.stop()}}),t)}))),function(e,t){return a.apply(this,arguments)})},{key:"destroyStream",value:function(t){e._zg.destroyStream(t)}},{key:"useCameraDevice",value:function(t,n){return e._zg.useVideoDevice(t,n)}},{key:"useMicrophoneDevice",value:function(t,n){return e._zg.useAudioDevice(t,n)}},{key:"useSpeakerDevice",value:(i=d(u().mark((function t(n,o){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.srcObject){t.next=2;break}return t.abrupt("return",Promise.resolve({errorCode:-1}));case 2:return t.prev=2,t.next=5,e._zg.useAudioOutputDevice(n,o);case 5:return t.abrupt("return",{errorCode:t.sent?0:-1});case 9:return t.prev=9,t.t0=t.catch(2),t.abrupt("return",{errorCode:-1});case 12:case"end":return t.stop()}}),t,null,[[2,9]])}))),function(e,t){return i.apply(this,arguments)})},{key:"enableVideoCaptureDevice",value:(o=d(u().mark((function t(n,o){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._zg.enableVideoCaptureDevice(n,o));case 1:case"end":return t.stop()}}),t)}))),function(e,t){return o.apply(this,arguments)})},{key:"muteMicrophone",value:(n=d(u().mark((function t(n){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._zg.muteMicrophone(n));case 1:case"end":return t.stop()}}),t)}))),function(e){return n.apply(this,arguments)})},{key:"enterRoom",value:(t=d(u().mark((function t(){var n=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.status.loginRsp){t.next=2;break}return t.abrupt("return",Promise.resolve(!0));case 2:return e._zg.on("roomStreamUpdate",function(){var t=d(u().mark((function t(o,r,i,a){var s,c,l,d,p,m,h;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("ADD"!==r){t.next=16;break}s=[],c=0;case 3:if(c>=i.length){t.next=13;break}return l=i[c],t.next=7,e._zg.startPlayingStream(l.streamID);case 7:n.remoteStreamMap[l.streamID]={fromUser:l.user,media:d=t.sent,micStatus:d.getAudioTracks().length>0?"OPEN":"MUTE",cameraStatus:d.getVideoTracks().length>0?"OPEN":"MUTE",state:"PLAYING"},s.push(n.remoteStreamMap[l.streamID]);case 10:c++,t.next=3;break;case 13:n.onRemoteMediaUpdateCallBack&&n.onRemoteMediaUpdateCallBack("ADD",s),t.next=18;break;case 16:for(p=[],m=0;i.length>m;m++)p.push(n.remoteStreamMap[(h=i[m]).streamID]),delete n.remoteStreamMap[h.streamID],n.onRemoteMediaUpdateCallBack&&n.onRemoteMediaUpdateCallBack("DELETE",p);case 18:case"end":return t.stop()}}),t)})));return function(e,n,o,r){return t.apply(this,arguments)}}()),e._zg.on("remoteCameraStatusUpdate",(function(e,t){n.remoteStreamMap[e]&&(n.remoteStreamMap[e].cameraStatus=t,n.onRemoteMediaUpdateCallBack&&n.onRemoteMediaUpdateCallBack("UPDATE",[n.remoteStreamMap[e]]))})),e._zg.on("remoteMicStatusUpdate",(function(e,t){n.remoteStreamMap[e]&&(n.remoteStreamMap[e].micStatus=t,n.onRemoteMediaUpdateCallBack&&n.onRemoteMediaUpdateCallBack("UPDATE",[n.remoteStreamMap[e]]))})),e._zg.on("playerStateUpdate",(function(e){n.remoteStreamMap[e.streamID]&&(n.remoteStreamMap[e.streamID].state=e.state,n.onRemoteMediaUpdateCallBack&&n.onRemoteMediaUpdateCallBack("UPDATE",[n.remoteStreamMap[e.streamID]]))})),e._zg.on("roomUserUpdate",(function(e,t,o){n.onRemoteUserUpdateCallBack&&n.onRemoteUserUpdateCallBack(e,t,o)})),e._zg.on("IMRecvBroadcastMessage",(function(e,t){n.onRoomMessageUpdateCallBack&&n.onRoomMessageUpdateCallBack(e,t)})),e._zg.on("roomStateUpdate",(function(e,t,o,r){n.onNetworkStatusCallBack&&n.onNetworkStatusCallBack(e,"ROOM",t)})),e._zg.on("publisherStateUpdate",(function(t){var o="DISCONNECTED";"PUBLISHING"===t.state?o="CONNECTED":"NO_PUBLISH"===t.state?o="DISCONNECTED":"PUBLISH_REQUESTING"===t.state&&(o="CONNECTING"),n.onNetworkStatusCallBack&&n.onNetworkStatusCallBack(e._instance._expressConfig.roomID,"STREAM",o)})),t.next=12,e._zg.loginRoom(e._instance._expressConfig.roomID,e._instance._expressConfig.token,{userID:e._instance._expressConfig.userID,userName:e._instance._expressConfig.userName},{userUpdate:!0,maxMemberCount:2});case 12:return this.status.loginRsp=t.sent,t.abrupt("return",this.status.loginRsp);case 14:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"publishLocalStream",value:function(t){return!!t&&e._zg.startPublishingStream(this._expressConfig.userID+"_"+function(e){var t="";if(t)return t;var n,o="12345qwertyuiopasdfgh67890jklmnbvcxzMNBVCZXASDQWERTYHGFUIOLKJP";for(e=e||5,n=0;e>n;n++)t+=o.charAt(Math.floor(62*Math.random()));return t}(3),t)}},{key:"onRemoteMediaUpdate",value:function(e){this.onRemoteMediaUpdateCallBack=e}},{key:"onRemoteUserUpdate",value:function(e){this.onRemoteUserUpdateCallBack=e}},{key:"sendRoomMessage",value:function(t){return e._zg.sendBroadcastMessage(e._instance._expressConfig.roomID,t)}},{key:"onRoomMessageUpdate",value:function(e){this.onRoomMessageUpdateCallBack=e}},{key:"onNetworkStatus",value:function(e){this.onNetworkStatusCallBack=e}},{key:"leaveRoom",value:function(){this.status.loginRsp&&(e._zg.off("roomStreamUpdate"),e._zg.off("remoteCameraStatusUpdate"),e._zg.off("remoteMicStatusUpdate"),e._zg.off("playerStateUpdate"),e._zg.off("roomUserUpdate"),e._zg.off("IMRecvBroadcastMessage"),e._zg.off("roomStateUpdate"),e._zg.off("publisherStateUpdate"),this.onNetworkStatusCallBack=function(){},this.onRemoteMediaUpdateCallBack=function(){},this.onRemoteUserUpdateCallBack=function(){},this.onRoomMessageUpdateCallBack=function(){},e._zg.logoutRoom(),this.status.loginRsp=!1)}}],[{key:"getInstance",value:function(t){var n=function(e){if(e.split("#").length>1){var t=JSON.parse(window.atob(e.split("#")[1]));return{appID:1*t.appID,userID:t.userID,userName:t.userName,roomID:t.roomID,token:e.split("#")[0]}}console.error("【ZEGOCLOUD】Token error")}(t);return!e._instance&&n&&((e._instance=new e)._expressConfig=n,e._soundMeter=new k,e._zg=new r(e._instance._expressConfig.appID,"wss://webliveroom"+e._instance._expressConfig.appID+"-api.zegocloud.com/ws")),e._instance}}]),e}();function w(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}O._instance=void 0,O._zg=void 0,O._soundMeter=void 0;var C={ZegoBrowserCheckNotSupport:"index-module_ZegoBrowserCheckNotSupport__1MXri",image:"index-module_image__2hbGP",content:"index-module_content__2i1Ii",ZegoBrowserCheckSupport:"index-module_ZegoBrowserCheckSupport__HsEuZ",videoScree:"index-module_videoScree__V6WiV",settings:"index-module_settings__R7NB0",video:"index-module_video__3TXUi",handler:"index-module_handler__3rX1i",joinScreen:"index-module_joinScreen__2BeCk",title:"index-module_title__1VOns",userName:"index-module_userName__26C1x",joinRoom:"index-module_joinRoom__1qrk-",inviteLink:"index-module_inviteLink__W2V3H"};w('.index-module_ZegoBrowserCheckNotSupport__1MXri {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center; }\n  .index-module_ZegoBrowserCheckNotSupport__1MXri .index-module_image__2hbGP {\n    background-image: "";\n    background-size: contain; }\n  .index-module_ZegoBrowserCheckNotSupport__1MXri .index-module_content__2i1Ii {\n    font-size: 12px; }\n\n.index-module_ZegoBrowserCheckSupport__HsEuZ {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center; }\n  .index-module_ZegoBrowserCheckSupport__HsEuZ .index-module_videoScree__V6WiV {\n    width: 55%;\n    height: 80%;\n    position: relative; }\n    .index-module_ZegoBrowserCheckSupport__HsEuZ .index-module_videoScree__V6WiV .index-module_settings__R7NB0 {\n      position: absolute;\n      top: 5px;\n      right: 5px;\n      z-index: 99; }\n    .index-module_ZegoBrowserCheckSupport__HsEuZ .index-module_videoScree__V6WiV .index-module_video__3TXUi {\n      width: 100%;\n      height: 100%; }\n    .index-module_ZegoBrowserCheckSupport__HsEuZ .index-module_videoScree__V6WiV .index-module_handler__3rX1i {\n      position: absolute;\n      bottom: 15px;\n      display: flex;\n      width: 100%;\n      justify-content: center; }\n      .index-module_ZegoBrowserCheckSupport__HsEuZ .index-module_videoScree__V6WiV .index-module_handler__3rX1i a {\n        margin-right: 30px; }\n  .index-module_ZegoBrowserCheckSupport__HsEuZ .index-module_joinScreen__2BeCk {\n    width: 35%;\n    height: 80%;\n    flex-direction: column;\n    display: flex; }\n    .index-module_ZegoBrowserCheckSupport__HsEuZ .index-module_joinScreen__2BeCk .index-module_title__1VOns {\n      font-size: 14px;\n      font-weight: 500; }\n    .index-module_ZegoBrowserCheckSupport__HsEuZ .index-module_joinScreen__2BeCk .index-module_userName__26C1x {\n      width: 80%;\n      height: 45px; }\n    .index-module_ZegoBrowserCheckSupport__HsEuZ .index-module_joinScreen__2BeCk .index-module_joinRoom__1qrk- {\n      width: 80%;\n      height: 45px; }\n    .index-module_ZegoBrowserCheckSupport__HsEuZ .index-module_joinScreen__2BeCk .index-module_inviteLink__W2V3H {\n      width: 80%;\n      height: 45px; }\n');var R={frame:"index-module_frame__1EKOD",body:"index-module_body__lu3M_",header:"index-module_header__3D4-f",content:"index-module_content__3qbwO",left:"index-module_left__31k2s",rightAudio:"index-module_rightAudio__38Wib",rightVideo:"index-module_rightVideo__2AwyY",preview:"index-module_preview__32gPB",noFrame:"index-module_noFrame__2Pswi"};w(".index-module_frame__1EKOD {\n  display: flex;\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  justify-content: center;\n  align-items: center;\n  background-color: #0000004f;\n  top: 0;\n  z-index: 9999; }\n  .index-module_frame__1EKOD .index-module_body__lu3M_ {\n    width: 40vw;\n    height: 60vh;\n    display: flex;\n    flex-direction: column;\n    background-color: #fffffffa; }\n    .index-module_frame__1EKOD .index-module_body__lu3M_ .index-module_header__3D4-f {\n      height: 45px;\n      display: flex;\n      justify-content: space-between;\n      padding: 10px;\n      align-items: center; }\n    .index-module_frame__1EKOD .index-module_body__lu3M_ .index-module_content__3qbwO {\n      flex: 1;\n      display: flex; }\n      .index-module_frame__1EKOD .index-module_body__lu3M_ .index-module_content__3qbwO .index-module_left__31k2s {\n        width: 60px;\n        height: 100%;\n        display: flex;\n        flex-direction: column; }\n      .index-module_frame__1EKOD .index-module_body__lu3M_ .index-module_content__3qbwO .index-module_rightAudio__38Wib,\n      .index-module_frame__1EKOD .index-module_body__lu3M_ .index-module_content__3qbwO .index-module_rightVideo__2AwyY {\n        flex: 1;\n        display: flex;\n        flex-direction: column;\n        padding: 10px; }\n        .index-module_frame__1EKOD .index-module_body__lu3M_ .index-module_content__3qbwO .index-module_rightAudio__38Wib .index-module_preview__32gPB,\n        .index-module_frame__1EKOD .index-module_body__lu3M_ .index-module_content__3qbwO .index-module_rightVideo__2AwyY .index-module_preview__32gPB {\n          flex: 1; }\n          .index-module_frame__1EKOD .index-module_body__lu3M_ .index-module_content__3qbwO .index-module_rightAudio__38Wib .index-module_preview__32gPB video,\n          .index-module_frame__1EKOD .index-module_body__lu3M_ .index-module_content__3qbwO .index-module_rightVideo__2AwyY .index-module_preview__32gPB video {\n            height: 30vh;\n            background-color: black; }\n\n.index-module_noFrame__2Pswi {\n  display: none; }\n");var D=function(n){_(v,i.Component);var o,r,a,s,c,l,m,f=y(v);function v(){var e;p(this,v);for(var t=arguments.length,n=Array(t),o=0;t>o;o++)n[o]=arguments[o];return(e=f.call.apply(f,[this].concat(n))).state={visible:!0,seletTab:"AUDIO",seletMic:void 0,seletSpeaker:void 0,seletCamera:void 0,micDevices:[],speakerDevices:[],cameraDevices:[],localVideoStream:void 0,localAudioStream:void 0,seletVideoResolve:"480"},e.videoRef=i.createRef(),e}return h(v,[{key:"componentDidMount",value:function(){this.getDevices(),this.props.localAudioStream||this.props.localVideoStream?this.props.localAudioStream&&this.props.localVideoStream&&this.setState({localAudioStream:this.props.localAudioStream,localVideoStream:this.props.localVideoStream}):(this.props.core._config.cameraEnabled&&this.createVideoStream({camera:{video:!0,audio:!1}}),this.props.core._config.micEnabled&&this.createAudioStream({camera:{video:!1,audio:!0}}))}},{key:"getDevices",value:(m=d(u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.core.getMicrophones();case 2:return t=e.sent,e.next=5,this.props.core.getSpeakers();case 5:return n=e.sent,e.next=8,this.props.core.getCameras();case 8:this.setState({micDevices:t,speakerDevices:n,cameraDevices:e.sent,seletMic:sessionStorage.getItem("seletMic")||void 0,seletSpeaker:sessionStorage.getItem("seletSpeaker")||void 0,seletCamera:sessionStorage.getItem("seletCamera")||void 0,seletVideoResolve:sessionStorage.getItem("seletVideoResolve")||void 0});case 10:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"createVideoStream",value:(l=d(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.core.createStream(t);case 3:return this.setState({localVideoStream:e.sent}),e.abrupt("return",!0);case 8:return e.prev=8,e.t0=e.catch(0),console.error("【ZEGOCLOUD】settings/localVideoStream failed !!",JSON.stringify(e.t0)),this.props.core._config.cameraEnabled=!1,e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(e){return l.apply(this,arguments)})},{key:"createAudioStream",value:(c=d(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.core.createStream(t);case 3:return this.setState({localAudioStream:e.sent}),e.abrupt("return",!0);case 8:return e.prev=8,e.t0=e.catch(0),console.error("【ZEGOCLOUD】settings/localAudioStream failed !!",JSON.stringify(e.t0)),this.props.core._config.micEnabled=!1,e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(e){return c.apply(this,arguments)})},{key:"toggleMic",value:(s=d(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.localAudioStream){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.props.core.useMicrophoneDevice(this.state.localAudioStream,t);case 4:0===e.sent.errorCode&&this.setState({seletMic:t});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"toggleSpeaker",value:(a=d(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.localAudioStream){e.next=2;break}return e.abrupt("return");case 2:this.setState({seletSpeaker:t});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"toggleCamera",value:(r=d(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.localVideoStream){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.props.core.useCameraDevice(this.state.localVideoStream,t);case 4:0===e.sent.errorCode&&this.setState({seletCamera:t});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"toggleVideoResolve",value:(o=d(u().mark((function e(t){var n,o,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.localVideoStream){e.next=2;break}return e.abrupt("return");case 2:return n=640,o=480,r=500,"180"===t?(n=320,o=180,r=140):"360"===t?(n=640,o=360,r=400):"480"===t?(n=640,o=480,r=500):"720"===t&&(n=1280,o=720,r=1130),e.next=6,this.props.core.setVideoConfig(this.state.localVideoStream,{width:n,height:o,maxBitrate:r,frameRate:15});case 6:e.sent&&this.setState({seletVideoResolve:t});case 8:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"close",value:function(){sessionStorage.setItem("seletMic",this.state.seletMic||""),sessionStorage.setItem("seletCamera",this.state.seletCamera||""),sessionStorage.setItem("seletSpeaker",this.state.seletSpeaker||""),sessionStorage.setItem("seletVideoResolve",this.state.seletVideoResolve||""),this.setState({visible:!1}),this.props.closeCallBack&&this.props.closeCallBack()}},{key:"render",value:function(){var n=this;return e("div",{className:this.state.visible?R.frame:R.noFrame,children:t("div",{className:R.body,children:[t("div",{className:R.header,children:[e("div",{children:"Header"}),e("div",{onClick:function(){n.close()},children:"close"})]}),t("div",{className:R.content,children:[t("div",{className:R.left,children:[e("button",{onClick:function(){n.setState({seletTab:"AUDIO"})},children:"音频"}),e("button",{onClick:function(){n.setState({seletTab:"VIDEO"})},children:"视频"})]}),"AUDIO"===this.state.seletTab&&t("div",{className:R.rightAudio,children:[t("div",{className:R.device,children:["mic:",e("select",{value:this.state.seletMic,onChange:function(e){n.toggleMic(e.target.value)},children:this.state.micDevices.map((function(t,n){return e("option",{value:t.deviceID,children:t.deviceName},n)}))})]}),t("div",{className:R.device,children:["speaker:",e("select",{value:this.state.seletSpeaker,onChange:function(e){n.toggleSpeaker(e.target.value)},children:this.state.speakerDevices.map((function(t,n){return e("option",{value:t.deviceID,children:t.deviceName},n)}))})]}),e("audio",{style:{width:"1px",height:"1px"},ref:function(e){e&&n.state.localAudioStream&&e.srcObject!==n.state.localAudioStream&&(e.srcObject=n.state.localAudioStream),e&&n.state.localAudioStream&&e.srcObject&&e.sinkId&&e.sinkId!==n.state.seletSpeaker&&(e.sinkId=n.state.seletSpeaker)}})]}),"VIDEO"===this.state.seletTab&&t("div",{className:R.rightVideo,children:[t("div",{className:R.device,children:["camera:",e("select",{value:this.state.seletCamera,onChange:function(e){n.toggleCamera(e.target.value)},children:this.state.cameraDevices.map((function(t,n){return e("option",{value:t.deviceID,children:t.deviceName},n)}))})]}),e("div",{className:R.preview,children:e("video",{controls:!0,muted:!0,autoPlay:!0,ref:function(e){e&&n.state.localVideoStream&&e.srcObject!==n.state.localVideoStream&&(e.srcObject=n.state.localVideoStream)}})}),t("div",{className:R.device,children:["camera:",t("select",{value:this.state.seletVideoResolve,onChange:function(e){n.toggleVideoResolve(e.target.value)},children:[e("option",{value:"180",children:"180p"}),e("option",{value:"360",children:"360p"}),e("option",{value:"480",children:"480p"}),e("option",{value:"720",children:"720p"})]})]})]})]})]})})}}]),v}(),N=document.createElement("div");document.body.appendChild(N);var E=function(t){var n=o.createRoot(N);n.render(e(D,{core:t.core,closeCallBack:function(){n.unmount(),t.closeCallBack()},localVideoStream:t.localVideoStream,localAudioStream:t.localAudioStream}))},M=function(n){_(l,i.Component);var o,r,a,s,c=y(l);function l(e){var t;return p(this,l),(t=c.call(this,e)).state={isSupportWebRTC:!1,localStream:void 0,userName:"xxx"},t.videoRef=void 0,t.inviteRef=void 0,t.videoOpen=!0,t.audioOpen=!0,t.videoRef=i.createRef(),t.inviteRef=i.createRef(),t}return h(l,[{key:"componentDidMount",value:(s=d(u().mark((function e(){var t,n,o=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.core.checkWebRTC();case 2:if(t=e.sent,this.videoOpen=!!this.props.core._config.cameraEnabled,this.audioOpen=!!this.props.core._config.micEnabled,!t||!this.videoOpen&&!this.audioOpen){e.next=17;break}return e.prev=6,e.next=9,this.props.core.createStream({camera:{video:this.videoOpen,audio:this.audioOpen}});case 9:this.setState({isSupportWebRTC:t,localStream:n=e.sent,userName:this.props.core._expressConfig.userName},(function(){o.videoRef.current&&n&&(o.videoRef.current.srcObject=n)})),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(6),console.error("【ZEGOCLOUD】  createStream failed!!",JSON.stringify(e.t0)),this.setState({isSupportWebRTC:t,localStream:void 0,userName:this.props.core._expressConfig.userName},(function(){o.videoRef.current&&n&&(o.videoRef.current.srcObject=n)}));case 17:case"end":return e.stop()}}),e,this,[[6,13]])}))),function(){return s.apply(this,arguments)})},{key:"createStream",value:(a=d(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.core.createStream({camera:{video:this.videoOpen,audio:this.audioOpen}});case 3:return this.setState({localStream:e.sent}),e.abrupt("return",!0);case 8:return e.prev=8,e.t0=e.catch(0),console.error("【ZEGOCLOUD】toggleStream/createStream failed !!",JSON.stringify(e.t0)),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return a.apply(this,arguments)})},{key:"toggleStream",value:(r=d(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("video"!==t){e.next=12;break}if(this.videoOpen=!this.videoOpen,this.state.localStream){e.next=9;break}return e.next=5,this.createStream();case 5:!e.sent&&(this.videoOpen=!this.videoOpen),e.next=10;break;case 9:this.props.core.enableVideoCaptureDevice(this.state.localStream,this.videoOpen);case 10:e.next=14;break;case 12:this.audioOpen=!this.audioOpen,this.state.localStream?this.props.core.muteMicrophone(this.audioOpen):!this.createStream()&&(this.audioOpen=!this.audioOpen);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"joinRoom",value:(o=d(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.core._expressConfig.userName=this.state.userName,this.props.core._config.micEnabled=this.audioOpen,this.props.core._config.cameraEnabled=this.videoOpen,e.next=5,this.props.core.enterRoom();case 5:e.sent?(this.props.joinRoom&&this.props.joinRoom(),this.state.localStream&&this.props.core.destroyStream(this.state.localStream)):console.error("【ZEGOCLOUD】Room is full !!");case 7:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"handleChange",value:function(e){this.setState({userName:e.target.value})}},{key:"openSettings",value:function(){E({core:this.props.core,closeCallBack:function(){}})}},{key:"render",value:function(){var n,o,r,i=this;this.state.isSupportWebRTC?n=t("div",{className:C.ZegoBrowserCheckSupport,children:[t("div",{className:C.videoScree,children:[e("a",{className:C.settings,onClick:function(){i.openSettings()},children:"settings"}),e("video",{className:C.video,autoPlay:!0,muted:!0,ref:this.videoRef}),t("div",{className:C.handler,children:[this.props.core._config.userCanToggleSelfMic&&e("a",{onClick:function(){i.toggleStream("audio")},children:"mic"}),this.props.core._config.userCanToggleSelfCamera&&e("a",{onClick:function(){i.toggleStream("video")},children:"camera"})]})]}),t("div",{className:C.joinScreen,children:[e("div",{className:C.title,children:null===(o=this.props.core._config.joinScreen)||void 0===o?void 0:o.title}),e("input",{className:C.userName,placeholder:"enter userName",value:this.state.userName,onChange:function(e){i.handleChange(e)}}),e("button",{className:C.joinRoom,onClick:function(){i.joinRoom()},children:"joinRoom"}),e("input",{className:C.inviteLink,placeholder:"inviteLink",readOnly:!0,value:null===(r=this.props.core._config.joinScreen)||void 0===r?void 0:r.inviteURL,ref:this.inviteRef}),e("button",{className:C.copyLink,onClick:function(){var e,t;i.inviteRef.current&&(e=i.inviteRef.current.value,t=i.inviteRef.current,navigator&&navigator.clipboard?navigator&&navigator.clipboard&&navigator.clipboard.writeText(e):(t.select(),document.execCommand("copy")))},children:"copyLink"})]})]}):n=t("div",{className:C.ZegoBrowserCheckNotSupport,children:[e("div",{className:C.image}),e("div",{className:C.content,children:"The current browser does not support this function, please change the chrome to use"})]});return n}}]),l}(),L="index-module_ZegoRoom__3VOYD",j="index-module_header__4nqXm",V="index-module_brand__zzBDh",U="index-module_content__25syb",I="index-module_contentLeft__pCybL",B="index-module_notification__2xSej",A="index-module_contentRight__2FeDd",T="index-module_listHeader__OFQ7o",z="index-module_listContent__3yC4V",P="index-module_footer__23dib",Z="index-module_handlerLeft__3ph9c",G="index-module_handlerMiddle__3sXhs",Y="index-module_handlerRight__3ORf6";w(".index-module_ZegoRoom__3VOYD {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center; }\n  .index-module_ZegoRoom__3VOYD .index-module_header__4nqXm {\n    width: 100%;\n    height: 45px;\n    display: flex;\n    justify-content: space-between;\n    align-items: center; }\n    .index-module_ZegoRoom__3VOYD .index-module_header__4nqXm .index-module_brand__zzBDh {\n      width: 133px;\n      height: 18px;\n      margin-left: 20px;\n      background-size: contain;\n      background-image: url(../../../../sdkAssets/logo_zego.png); }\n    .index-module_ZegoRoom__3VOYD .index-module_header__4nqXm .index-module_timer__1SsOL {\n      margin-right: 20px; }\n  .index-module_ZegoRoom__3VOYD .index-module_content__25syb {\n    width: 100%;\n    flex: 1;\n    display: flex; }\n    .index-module_ZegoRoom__3VOYD .index-module_content__25syb .index-module_contentLeft__pCybL {\n      width: 70%;\n      position: relative;\n      display: flex;\n      justify-content: center;\n      background-color: black;\n      border-radius: 19px; }\n      .index-module_ZegoRoom__3VOYD .index-module_content__25syb .index-module_contentLeft__pCybL .index-module_notification__2xSej {\n        position: absolute;\n        left: 5px;\n        bottom: 5px;\n        width: 40%;\n        height: 30%;\n        flex-direction: column;\n        display: flex;\n        color: red; }\n    .index-module_ZegoRoom__3VOYD .index-module_content__25syb .index-module_contentRight__2FeDd {\n      width: 30%;\n      border-radius: 19px;\n      display: flex;\n      flex-direction: column;\n      margin: 0px 20px 0px 50px;\n      background-color: aliceblue; }\n      .index-module_ZegoRoom__3VOYD .index-module_content__25syb .index-module_contentRight__2FeDd .index-module_listHeader__OFQ7o {\n        height: 40px;\n        display: flex;\n        align-items: center;\n        padding-left: 40px; }\n      .index-module_ZegoRoom__3VOYD .index-module_content__25syb .index-module_contentRight__2FeDd .index-module_listContent__3yC4V {\n        flex: 1;\n        display: flex;\n        flex-direction: column; }\n      .index-module_ZegoRoom__3VOYD .index-module_content__25syb .index-module_contentRight__2FeDd .index-module_listFooter__2GcOm {\n        height: 40px;\n        display: flex;\n        align-items: center; }\n  .index-module_ZegoRoom__3VOYD .index-module_footer__23dib {\n    width: 100%;\n    height: 45px;\n    display: flex;\n    justify-content: space-between;\n    align-items: center; }\n    .index-module_ZegoRoom__3VOYD .index-module_footer__23dib .index-module_handlerLeft__3ph9c {\n      width: 40px; }\n    .index-module_ZegoRoom__3VOYD .index-module_footer__23dib .index-module_handlerMiddle__3sXhs {\n      flex: 1;\n      display: flex;\n      justify-content: center; }\n      .index-module_ZegoRoom__3VOYD .index-module_footer__23dib .index-module_handlerMiddle__3sXhs a {\n        margin-right: 20px; }\n    .index-module_ZegoRoom__3VOYD .index-module_footer__23dib .index-module_handlerRight__3ORf6 a {\n      margin-right: 20px; }\n");var H=function(t){_(o,i.Component);var n=y(o);function o(){var e;p(this,o);for(var t=arguments.length,r=Array(t),i=0;t>i;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))).state={time:0},e}return h(o,[{key:"startTimer",value:function(){var e=this;setTimeout((function(){e.setState((function(e){return{time:++e.time}}),(function(){e.startTimer()}))}),1e3)}},{key:"componentDidMount",value:function(){this.startTimer()}},{key:"render",value:function(){return e("div",{children:(t=this.state.time,[t/3600,t/60,t%60].map((function(e){return(10>e?"0":"")+Math.floor(e)})).join(":"))});var t}}]),o}(),F="zegoOne2One-module_bigVideo__3ivPo",q="zegoOne2One-module_smallVideo__1Sww7",W="zegoOne2One-module_name__1udPz";w(".zegoOne2One-module_bigVideo__3ivPo,\n.zegoOne2One-module_smallVideo__1Sww7 {\n  background-color: black;\n  position: relative; }\n  .zegoOne2One-module_bigVideo__3ivPo .zegoOne2One-module_name__1udPz,\n  .zegoOne2One-module_smallVideo__1Sww7 .zegoOne2One-module_name__1udPz {\n    position: absolute;\n    bottom: 15px;\n    left: 15px; }\n  .zegoOne2One-module_bigVideo__3ivPo video,\n  .zegoOne2One-module_smallVideo__1Sww7 video {\n    height: 100%; }\n\n.zegoOne2One-module_bigVideo__3ivPo {\n  width: auto;\n  height: 100%; }\n\n.zegoOne2One-module_smallVideo__1Sww7 {\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  width: auto;\n  height: 30%; }\n\n.zegoOne2One-module_notification__H1BoO {\n  position: absolute;\n  left: 5px;\n  bottom: 5px;\n  width: 40%;\n  height: 30%; }\n");var X=function(o){_(a,i.Component);var r=y(a);function a(){return p(this,a),r.apply(this,arguments)}return h(a,[{key:"getVideoScreen",value:function(){var o=this;return this.props.localStream&&this.props.remoteStreamInfo?t(n,{children:[t("div",{className:F,children:[e("video",{autoPlay:!0,ref:function(e){e&&e.srcObject!==o.props.localStream&&(e.srcObject=o.props.localStream)}}),e("div",{className:W,children:this.props.remoteStreamInfo.fromUser.userName})]}),t("div",{className:q,children:[e("video",{muted:!0,autoPlay:!0,ref:function(e){e&&e.srcObject!==o.props.localStream&&(e.srcObject=o.props.localStream)}}),e("div",{className:W,children:"You"})]})]}):this.props.localStream?t("div",{className:F,children:[e("video",{muted:!0,autoPlay:!0,ref:function(e){e&&e.srcObject!==o.props.localStream&&(e.srcObject=o.props.localStream)}}),e("div",{className:W,children:"You"})]}):this.props.remoteStreamInfo?t("div",{className:F,children:[e("video",{autoPlay:!0,className:F,ref:function(e){e&&e.srcObject!==o.props.remoteStreamInfo.media&&(e.srcObject=o.props.remoteStreamInfo.media)}}),e("div",{className:W,children:this.props.remoteStreamInfo.fromUser.userName})]}):void 0}},{key:"render",value:function(){return e(n,{children:this.getVideoScreen()})}}]),a}(),K="zegoMessage-module_listHeader__YjknV",J="zegoMessage-module_listContent__2rHFG",Q="zegoMessage-module_listFooter__3v4Jt";w(".zegoMessage-module_listHeader__YjknV {\n  height: 40px;\n  display: flex;\n  align-items: center;\n  padding-left: 40px; }\n\n.zegoMessage-module_listContent__2rHFG {\n  flex: 1;\n  display: flex;\n  flex-direction: column; }\n\n.zegoMessage-module_listFooter__3v4Jt {\n  height: 40px;\n  display: flex;\n  align-items: center; }\n");var $=function(o){_(a,i.Component);var r=y(a);function a(){var e;p(this,a);for(var t=arguments.length,n=Array(t),o=0;t>o;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n))).state={message:""},e}return h(a,[{key:"messageInput",value:function(e){this.setState({message:e.target.value})}},{key:"render",value:function(){var o=this;return t(n,{children:[e("div",{className:K,children:"消息列表"}),e("div",{className:J,children:this.props.messageList.map((function(e){return t("a",{children:[e.fromUser.userName,":",e.message]},e.messageID)}))}),t("div",{className:Q,children:[e("input",{value:this.state.message,onChange:function(e){o.messageInput(e)}}),e("button",{onClick:function(){o.props.sendMessage(o.state.message),o.setState({message:""})},children:"send"})]})]})}}]),a}();function ee(e){var t="";if(t)return t;var n,o="12345qwertyuiopasdfgh67890jklmnbvcxzMNBVCZXASDQWERTYHGFUIOLKJP";for(e=e||5,n=0;e>n;n++)t+=o.charAt(Math.floor(62*Math.random()));return t}var te=function(o){_(m,i.Component);var r,a,s,c,l=y(m);function m(){var e;p(this,m);for(var t=arguments.length,n=Array(t),o=0;t>o;o++)n[o]=arguments[o];return(e=l.call.apply(l,[this].concat(n))).state={localStream:void 0,remoteStreamInfo:void 0,layOutStatus:"ONE_VIDEO",userList:[],messageList:[],notificationList:[]},e.micOpen=e.props.core._config.micEnabled,e.cameraOpen=e.props.core._config.cameraEnabled,e}return h(m,[{key:"componentDidMount",value:function(){this.initSDK()}},{key:"initSDK",value:(c=d(u().mark((function e(){var t=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.core.onNetworkStatus((function(e,n,o){"DISCONNECTED"===o&&t.leaveRoom()})),this.props.core.onRemoteUserUpdate((function(e,n,o){var r,i=[];(null===(r=t.props.core._config.notification)||void 0===r?void 0:r.userOnlineOfflineTips)&&("ADD"===n?i=o.map((function(e){return e.userName+": enter room"})):"DELETE"===n&&(i=S(o.map((function(e){return e.userName+": leave room"}))))),"ADD"===n?t.setState((function(e){return{userList:[].concat(S(e.userList),S(o)),notificationList:[].concat(S(e.notificationList),S(i))}})):"DELETE"===n&&t.setState((function(e){return{userList:e.userList.filter((function(e){return!o.some((function(t){return e.userID===t.userID}))})),notificationList:[].concat(S(e.notificationList),S(i))}}))})),this.props.core.onRemoteMediaUpdate((function(e,n){"ADD"===e||"UPDATE"===e?t.setState({remoteStreamInfo:n[0]}):"DELETE"===e&&t.setState({remoteStreamInfo:void 0})})),this.props.core.onRoomMessageUpdate((function(e,n){t.setState((function(e){var o,r=[];return"MESSAGE"!==t.state.layOutStatus&&(null===(o=t.props.core._config.notification)||void 0===o?void 0:o.unreadMessageTips)&&(r=[].concat(S(e.notificationList),S(n.map((function(e){return e.fromUser.userName+": "+e.message}))))),{messageList:[].concat(S(e.messageList),S(n)),notificationList:r}}))})),e.next=6,this.props.core.enterRoom();case 6:e.sent&&this.createStream(!!this.props.core._config.cameraEnabled,!!this.props.core._config.micEnabled);case 8:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"createStream",value:(s=d(u().mark((function e(t,n){var o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t&&!n){e.next=16;break}return e.prev=1,e.next=4,this.props.core.createStream({camera:{video:t,audio:n}});case 4:return this.setState({localStream:o=e.sent}),this.props.core.publishLocalStream(o),e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(1),console.error("【ZEGOCLOUD】createStream or publishLocalStream failed,Reason: ",JSON.stringify(e.t0)),e.abrupt("return",!1);case 14:e.next=17;break;case 16:return e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e,t){return s.apply(this,arguments)})},{key:"toggleMic",value:(a=d(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.micOpen=!this.micOpen,!this.state.localStream){e.next=5;break}this.props.core.muteMicrophone(this.micOpen),e.next=9;break;case 5:return e.next=7,this.createStream(!!this.cameraOpen,!!this.micOpen);case 7:!e.sent&&(this.micOpen=!this.micOpen);case 9:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"toggleCamera",value:(r=d(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.cameraOpen=!this.cameraOpen,!this.state.localStream){e.next=5;break}this.props.core.enableVideoCaptureDevice(this.state.localStream,this.cameraOpen),e.next=9;break;case 5:return e.next=7,this.createStream(!!this.cameraOpen,!!this.micOpen);case 7:!e.sent&&(this.cameraOpen=!this.cameraOpen);case 9:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"toggleLayOut",value:function(e){this.setState((function(t){return{layOutStatus:t.layOutStatus===e?"ONE_VIDEO":e}}))}},{key:"sendMessage",value:function(e){var t=this;this.props.core.sendRoomMessage(e),this.setState((function(n){return{messageList:[].concat(S(n.messageList),[{fromUser:{userID:t.props.core._expressConfig.userID,userName:t.props.core._expressConfig.userName},message:e,sendTime:Date.now(),messageID:ee(3)}])}}))}},{key:"openSettings",value:function(){E({core:this.props.core,closeCallBack:function(){},localAudioStream:this.state.localStream,localVideoStream:this.state.localStream})}},{key:"leaveRoom",value:function(){this.props.core.leaveRoom(),this.props.leaveRoom&&this.props.leaveRoom()}},{key:"getListScreen",value:function(){var o=this;return"INVITE"===this.state.layOutStatus?t(n,{children:[e("div",{className:T,children:"房间详情"}),e("div",{className:z})]}):"USER_LIST"===this.state.layOutStatus?t(n,{children:[e("div",{className:T,children:"成员列表"}),t("div",{className:z,children:[t("a",{children:[this.props.core._expressConfig.userName,"(You)"]}),this.state.userList.map((function(t){return e("a",{children:t.userName})}))]})]}):"MESSAGE"===this.state.layOutStatus?e($,{messageList:this.state.messageList,sendMessage:function(e){o.sendMessage(e)}}):void 0}},{key:"render",value:function(){var n,o,r,i,a=this;return t("div",{className:L,children:[t("div",{className:j,children:[(null===(n=this.props.core._config.branding)||void 0===n?void 0:n.logoURL)&&e("div",{className:V}),this.props.core._config.roomTimerDisplayed&&e(H,{})]}),t("div",{className:U,children:[t("div",{className:I,style:{width:"ONE_VIDEO"!==this.state.layOutStatus?"70%":"100%"},children:[e(X,{localStream:this.state.localStream,remoteStreamInfo:this.state.remoteStreamInfo}),((null===(o=this.props.core._config.notification)||void 0===o?void 0:o.unreadMessageTips)||(null===(r=this.props.core._config.notification)||void 0===r?void 0:r.userOnlineOfflineTips))&&e("div",{className:B,children:this.state.notificationList.map((function(t,n){return e("a",{children:t},n)}))})]}),e("div",{className:A,style:{display:"ONE_VIDEO"!==this.state.layOutStatus?"flex":"none"},children:this.getListScreen()})]}),t("div",{className:P,children:[(null===(i=this.props.core._config.joinScreen)||void 0===i?void 0:i.inviteURL)&&e("div",{className:Z,onClick:function(){a.toggleLayOut("INVITE")},children:"邀请"}),t("div",{className:G,children:[this.props.core._config.userCanToggleSelfMic&&e("a",{onClick:function(){a.toggleMic()},children:"mic"}),this.props.core._config.userCanToggleSelfCamera&&e("a",{onClick:function(){a.toggleCamera()},children:"camera"}),e("a",{onClick:function(){a.openSettings()},children:"more"}),e("a",{onClick:function(){a.leaveRoom()},children:"leave"})]}),t("div",{className:Y,children:[this.props.core._config.userListEnabled&&e("a",{onClick:function(){a.toggleLayOut("USER_LIST")},children:"user"}),this.props.core._config.chatEnabled&&e("a",{onClick:function(){a.toggleLayOut("MESSAGE")},children:"message"})]})]})]})}}]),m}(),ne="index-module_index__3eZPa";w(".index-module_index__3eZPa {\n  width: 100%;\n  height: 100%; }\n");var oe=function(t){_(r,i.Component);var n,o=y(r);function r(){return p(this,r),o.apply(this,arguments)}return h(r,[{key:"joinRoom",value:(n=d(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.core.enterRoom();case 2:e.sent?this.props.joinRoom&&this.props.joinRoom():console.error("【ZEGOCLOUD】Room is full !!");case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"render",value:function(){var t=this;return e("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e("button",{onClick:function(){t.joinRoom()},children:"RejoinRoom"})})}}]),r}(),re=function(t){_(o,i.Component);var n=y(o);function o(){var e,t;p(this,o);for(var r=arguments.length,i=Array(r),a=0;r>a;a++)i[a]=arguments[a];return(t=n.call.apply(n,[this].concat(i))).state={step:(null===(e=t.props.core._config.joinScreen)||void 0===e?void 0:e.visible)?0:1},t}return h(o,[{key:"nextPage",value:function(){this.setState((function(e){return{step:++e.step}}))}},{key:"render",value:function(){var t,n=this;return t=0===this.state.step&&this.props.core?e(M,{core:this.props.core,joinRoom:function(){n.nextPage()}}):1===this.state.step&&this.props.core?e(te,{core:this.props.core,leaveRoom:function(){n.props.core._config.leftScreen&&n.nextPage(),n.props.core._config.leaveRoomCallback&&n.props.core._config.leaveRoomCallback()}}):e(oe,{core:this.props.core,joinRoom:function(){n.setState({step:1})}}),e(a,{locale:"en",children:e("div",{className:ne,children:t})})}}]),o}(),ie=function(){function t(){p(this,t),this.root=void 0}return h(t,[{key:"joinRoom",value:function(n){t.core?n.container?(t.core.setConfig(n),this.root=o.createRoot(n.container),this.root.render(e(re,{core:t.core}))):console.error("【ZEGOCLOUD】joinRoom/roomConfig/container required !!"):console.error("【ZEGOCLOUD】 please call init first !!")}},{key:"destroyRoom",value:function(){var e;t.core.leaveRoom(),null===(e=this.root)||void 0===e||e.unmount(),this.root=void 0}}],[{key:"init",value:function(e){return!t.core&&e&&(t.core=O.getInstance(e),t._instance=new t),t._instance}}]),t}();ie.core=void 0,ie._instance=void 0;export default ie;
